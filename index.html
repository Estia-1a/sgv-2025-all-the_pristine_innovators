<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="styles/desktop.css">
    <title>La Cagette Folle</title>
</head>
<body>
    <header class="entete">
        <img class="logo" src="media/pictures/logo-cagette.png" alt="Logo La Cagette Folle">
        <div class="logo" style="display: none;">ğŸ›’</div>
        <h1>La Cagette Folle</h1>
    </header>
    
    <main>
        <div class="panier-navigation">
            <a href="panier.html" class="btn-panier">
                ğŸ›’ Panier
                <span class="badge-panier" id="badgePanier">0</span>
            </a>
        </div>

        <h2 class="section-titre">ğŸ Fruits</h2>
        <div class="produits-grid" id="fruitsList"></div>

        <h2 class="section-titre">ğŸ¥• LÃ©gumes</h2>
        <div class="produits-grid" id="legumesList"></div>
    </main>

    <script>
        // Catalogue de produits
        const catalogue = {
            fruits: [
                { id: 'pomme', nom: 'Pommes ', emoji: 'ğŸ', prix: 2.80, unite: 'kg' },
                { id: 'poire', nom: 'Poires', emoji: 'ğŸ', prix: 3.50, unite: 'kg' },
                { id: 'cerises', nom: 'Cerises', emoji: 'ğŸ’', prix: 1.50, unite: 'kg' }
            ],
            legumes: [
                { id: 'carottes', nom: 'Carottes', emoji: 'ğŸ¥•', prix: 2.20, unite: 'kg' },
                { id: 'courgettes', nom: 'Courgettes', emoji: 'ğŸ¥’', prix: 2.90, unite: 'kg' },
            ]
        };

        // QuantitÃ©s sÃ©lectionnÃ©es
        let quantites = {};

        // Initialiser les quantitÃ©s Ã  0
        [...catalogue.fruits, ...catalogue.legumes].forEach(produit => {
            quantites[produit.id] = 0;
        });

        // Fonction pour crÃ©er une carte produit
        function creerCarteProduit(produit) {
            return `
                <div class="produit-card">
                    <div class="produit-emoji">${produit.emoji}</div>
                    <div class="produit-nom">${produit.nom}</div>
                    <div class="produit-prix">${produit.prix.toFixed(2)} â‚¬ / ${produit.unite}</div>
                    <div class="quantite-section">
                        <div class="quantite-controls">
                            <button class="btn-quantite" onclick="diminuerQuantite('${produit.id}')" ${quantites[produit.id] === 0 ? 'disabled' : ''}>âˆ’</button>
                            <span class="quantite-display" id="qty-${produit.id}">${quantites[produit.id]}</span>
                            <button class="btn-quantite" onclick="augmenterQuantite('${produit.id}')">+</button>
                        </div>
                        <button class="btn-ajouter" onclick="ajouterAuPanier('${produit.id}')" ${quantites[produit.id] === 0 ? 'disabled' : ''}>
                            Ajouter au panier
                        </button>
                    </div>
                </div>
            `;
        }

        // Afficher les produits
        function afficherProduits() {
            document.getElementById('fruitsList').innerHTML = catalogue.fruits.map(creerCarteProduit).join('');
            document.getElementById('legumesList').innerHTML = catalogue.legumes.map(creerCarteProduit).join('');
        }

        // Augmenter la quantitÃ©
        function augmenterQuantite(id) {
            quantites[id]++;
            mettreAJourAffichage(id);
        }

        // Diminuer la quantitÃ©
        function diminuerQuantite(id) {
            if (quantites[id] > 0) {
                quantites[id]--;
                mettreAJourAffichage(id);
            }
        }

        // Mettre Ã  jour l'affichage
        function mettreAJourAffichage(id) {
            const qtyDisplay = document.getElementById(`qty-${id}`);
            if (qtyDisplay) {
                qtyDisplay.textContent = quantites[id];
            }
            afficherProduits();
        }

        // Ajouter au panier
        function ajouterAuPanier(id) {
            if (quantites[id] === 0) return;

            // RÃ©cupÃ©rer le panier existant
            let panier = JSON.parse(localStorage.getItem('panier') || '[]');
            
            // Trouver le produit
            const produit = [...catalogue.fruits, ...catalogue.legumes].find(p => p.id === id);
            
            // VÃ©rifier si le produit existe dÃ©jÃ  dans le panier
            const index = panier.findIndex(p => p.id === id);
            
            if (index !== -1) {
                // Augmenter la quantitÃ©
                panier[index].quantite += quantites[id];
            } else {
                // Ajouter le nouveau produit
                panier.push({
                    id: produit.id,
                    nom: produit.nom,
                    prix: produit.prix,
                    quantite: quantites[id],
                    unite: produit.unite
                });
            }
            
            // Sauvegarder dans localStorage
            localStorage.setItem('panier', JSON.stringify(panier));
            
            // RÃ©initialiser la quantitÃ©
            quantites[id] = 0;
            
            // Mettre Ã  jour l'affichage
            mettreAJourAffichage(id);
            mettreAJourBadgePanier();
            
            // Afficher un message
            alert(`${produit.nom} ajoutÃ©(s) au panier !`);
        }

        // Mettre Ã  jour le badge du panier
        function mettreAJourBadgePanier() {
            const panier = JSON.parse(localStorage.getItem('panier') || '[]');
            const total = panier.reduce((sum, p) => sum + p.quantite, 0);
            document.getElementById('badgePanier').textContent = total;
        }

        // Initialisation
        afficherProduits();
        mettreAJourBadgePanier();
    </script>
</body>
</html>